(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{59:function(e,t,a){e.exports=a(79)},78:function(e,t,a){},79:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(57),c=a.n(l),i=a(3),o=a(40);const s={Transactions:{path:"/transactions"},Import:{path:"/transactions/import"},Portfolio:{path:"/portfolio"}};var m=()=>{const{pathname:e}=Object(i.n)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"nav nav-tabs"},Object.keys(s).map(t=>r.a.createElement("li",{className:"nav-item",type:"submit"},r.a.createElement(o.b,{className:"nav-link ".concat(e===s[t].path?"active":""),to:s[t].path},t)))),r.a.createElement(i.a,null))},u=a(86),d=a(85);var p=()=>{const[e,t]=Object(n.useState)({show:!1,data:{save:0,not_save:0}});return r.a.createElement(r.a.Fragment,null,r.a.createElement("form",{className:"mb-3",onChange:e=>{e.preventDefault();const t=e.target.files[0];if(!t)return;const a={headers:{"Content-Type":"multipart/form-data"}},{name:n}=t;if(/xls(x)?$/.test(n)){const e=new FormData;e.append("file",e),u.a.post("https://d5dpil1j3vqslj3529om.apigw.yandexcloud.net/api/v1/transactions/import",t,a).then(e=>console.log(e))}}},r.a.createElement("label",{htmlFor:"formFile",className:"form-label"},"\u041f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0435 \u0431\u0440\u043e\u043a\u0435\u0440\u0441\u043a\u0438\u0435 \u043e\u0442\u0447\u0435\u0442\u044b: \u0422\u0438\u043d\u044c\u043a\u043e\u0444\u0444, \u0412\u0422\u0411"),r.a.createElement("input",{className:"form-control",type:"file",id:"formFile"})),r.a.createElement(d.a,{show:e.show,onHide:()=>{t({...e,show:!1})}},r.a.createElement(d.a.Body,null,"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439: ",e.data.save),r.a.createElement(d.a.Body,null,"\u041d\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 (\u0434\u0443\u0431\u043b\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435): ",e.data.not_save)))},h=a(10),y=a.n(h),v=a(88);var g=e=>{let{reqData:t,setReqData:a}=e;const{page:n,maxPage:l}=t,c=((e,t)=>{let a=null,n=null;t<=7?(a=1,n=t):e<=3?(a=1,n=7):e+3>=t?(a=t-6,n=t):(a=e-3,n=e+3);const r=Object(h.range)(a,n+1);return r[1]>2&&(r[1]=null),r[r.length-2]<t-1&&(r[r.length-2]=null),r[0]=1,r[r.length-1]=t,r})(n,l);return r.a.createElement(v.a,null,r.a.createElement(v.a.Prev,{onClick:()=>{n>1&&a({...t,page:n-1})}}),c.map(e=>null===e?r.a.createElement(v.a.Ellipsis,null):r.a.createElement(v.a.Item,{active:n===e||null,onClick:()=>(e=>a({...t,page:e}))(e)},e)),r.a.createElement(v.a.Next,{onClick:()=>{n!==l&&a({...t,page:n+1})}}))},E=a(83),_=a(84),f=a(58);var w=e=>{let{reqData:t,setReqData:a}=e;const{limit:n}=t;return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{className:"pagination",as:_.a,key:n,id:"button-customs",variant:"white",title:n},[10,25,50].map(e=>r.a.createElement(f.a.Item,{eventKey:e,onClick:()=>(e=>a({...t,limit:e}))(e),active:e===n},e))))};const b=e=>{const t=e.slice(0,4),a=e.slice(4,6),n=e.slice(6,8);return"".concat(n,".").concat(a,".").concat(t)};var N=e=>{const{data:t}=e,a=(t[0],["yield_last","yield_avg"]);t.forEach(e=>{a.forEach(t=>{e[t]&&(e[t]=(100*e[t]).toFixed(2))}),e.trade_date=b(e.trade_date)});const n={isin:"ISIN",trade_date:"Trade Date",count:"Quantity",price:"Price",summa:"Total amount"},r=Object.keys(n),l=t.map(e=>y.a.pick(e,r)).reduce((e,t)=>{const a={};return Object.keys(t).map(e=>{a[n[e]]=t[e]}),e.push(a),e},[]);return{...e,data:l}};var j=()=>r.a.createElement("svg",{className:"spinner",viewBox:"0 0 50 50"},r.a.createElement("circle",{className:"path",cx:"25",cy:"25",r:"20",fill:"none","stroke-width":"5"}));const k=e=>{switch(e.toLowerCase()){case"quantity":case"price":case"total amount":return"rigthContent";default:return"leftContent"}},O=e=>{let{tags:t}=e;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"tags"},Object.keys(t).map(e=>r.a.createElement("div",{className:k(e),key:Object(h.uniqueId)()},e))))},x=e=>{let{body:t}=e;return r.a.createElement(r.a.Fragment,null,t.map(e=>r.a.createElement("div",{className:"body",key:Object(h.uniqueId)()},Object.entries(e).map(e=>{let[t,a]=e;return r.a.createElement("div",{className:k(t),key:Object(h.uniqueId)()},a)}))))};var D=()=>{const[e,t]=Object(n.useState)("load"),[a,l]=Object(n.useState)({page:1,limit:25});return Object(n.useEffect)(()=>{t("load");const{page:e,limit:n}=a,r="https://d5dpil1j3vqslj3529om.apigw.yandexcloud.net/api/v1/transactions?limit=".concat(n,"&page=").concat(e);(async()=>await u.a.get(r).then(e=>{let{data:a}=e;a.data&&l(N(a)),t("loaded")}))()},[a.page,a.limit]),"load"===e?r.a.createElement(j,null):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"table"},r.a.createElement(O,{tags:a.data[0]}),r.a.createElement(x,{body:a.data})),r.a.createElement("div",{className:"pagination-limit"},0!==a.data.length&&r.a.createElement("tr",null,r.a.createElement("th",null,r.a.createElement(w,{reqData:a,setReqData:l})),r.a.createElement("th",null,r.a.createElement(g,{reqData:a,setReqData:l})))))},q=a(87),I=a(55),F=a.n(I);const T=e=>{const t=e.split(","),a=[...t[0]].reverse().join(""),n=t[1]||0;return Object(h.chunk)(a,3).reverse().map(e=>e.reverse().join("")).join(" ")+","+n},C=(e,t)=>e.reduce((e,a)=>{if(a[t]){a[t]=a[t].split(" ").join("");const n=new F.a(e.sum);e.sum=n.plus(Number(a[t].replace(",","."))).toString(),e.count+=1}return e},{sum:0,count:0}),S=e=>{let{sum:t,count:a}=e;return new F.a(t).div(a).toFixed(2)};var A=class{constructor(e){this.date=e,this.informations={name:{correctName:"Name",width:120},price_avg:{correctName:"Price Avg",width:90},price_daily:{correctName:"Price ".concat(this.date),width:150},yield_instrument_avg:{correctName:"Yield Avg",width:90},yield_instrument_daily:{correctName:"Yield ".concat(this.date),width:150},coupon_payment_frequency:{correctName:"Coupons",width:90},instrument_type:{correctName:"Type",width:70},accrued_coupon_eod:{correctName:"NKD",width:170},count:{correctName:"Count",width:100},current_investment:{correctName:"CI",width:100},rating:{correctName:"Rating",width:50},ccy:{correctName:"Ccy",width:50},date_daily:{correctName:"Daily Date",width:100},duration_daily:{correctName:"Duration",width:100},isin:{correctName:"ISIN",width:150},maturity_date:{correctName:"Maturity Date",width:100},activeType:["name","price_avg","price_daily","yield_instrument_avg","yield_instrument_daily","coupon_payment_frequency","instrument_type","accrued_coupon_eod","count","current_investment"]}}addData(e){this.informations.data=e.reduce((e,t)=>{const{instrument_type:a}=t;return e[a].push(t),e.all.push(t),e},{all:[],bond:[],stock:[]}),this.principal=1e3}setDate(e){return this.date=e,this}getStyleByActiveName(){return this.informations.activeType.reduce((e,t)=>{const{width:a}=this.informations[t];return{...e,[t]:a}},{})}getData(e){return e=e.toLowerCase(),this.informations.data?this.informations.data[e].map(e=>{const t=Object(h.pick)(e,this.informations.activeType);return t.accrued_coupon_eod=e.accrued_coupon_eod/100*this.principal*e.count||null,t.yield_instrument_daily=100*t.yield_instrument_daily||null,t.yield_instrument_avg=100*t.yield_instrument_avg||null,Object.keys(e).forEach(e=>{if("count"===e)t[e]=T("".concat(t[e],",0")).split(",")[0];else if("number"===typeof t[e]){const a=t[e].toFixed(2).replace(".",",");t[e]=T(a)}}),t}):null}getLength(){return this.informations.activeType.reduce((e,t)=>e+this.informations[t].width+20,0)}getTags(){return this.informations.activeType.reduce((e,t)=>(e.push(this.informations[t]),e),[])}getInfoForLine(e){e=e.toLowerCase();const t=this.getData(e),a=["accrued_coupon_eod","yield_instrument_avg","yield_instrument_daily","current_investment"],n={accrued_coupon_eod:C(t,"accrued_coupon_eod").sum,yield_instrument_avg:S(C(t,"yield_instrument_avg")),yield_instrument_daily:S(C(t,"yield_instrument_daily")),current_investment:C(t,"current_investment").sum};return this.informations.activeType.map(e=>{const t=this.informations[e].width;return a.includes(e)?{value:"NaN"===n[e]?null:T("".concat(n[e]).replace(".",",")),styleWidth:t}:{value:null,styleWidth:t}})}};var L=e=>{let{refresh:t}=e;return r.a.createElement("div",null,r.a.createElement("div",null,"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u0435\u0442\u0438"),r.a.createElement("button",{onClick:()=>t()},"\u041f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0441\u043d\u043e\u0432\u0430"))};const R=()=>{window.location.reload()};var B=e=>{switch(e){case"ERR_NETWORK":return r.a.createElement(L,{refresh:R})}};const P=e=>{let{activeType:t,setActiveType:a}=e;return r.a.createElement(q.a,{variant:"underline",defaultActiveKey:t},["Bond","Stock","All"].map(e=>r.a.createElement(q.a.Item,null,r.a.createElement(q.a.Link,{eventKey:e,onClick:()=>a(e)},e))))},K=e=>{let{info:t,length:a}=e;return r.a.createElement("div",{className:"portfolio-tags-info",style:{width:a+"px"}},t.map(e=>{let{value:t,styleWidth:a}=e;return r.a.createElement("div",{key:Object(h.uniqueId)(),style:{width:a+"px",textAlign:"right"}},t)}))},W=e=>{let{tags:t,length:a}=e;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"portfolio-tags",style:{width:a+"px"}},t.map(e=>{let{correctName:t,width:a}=e;return r.a.createElement("div",{key:Object(h.uniqueId)(),style:{width:a+"px"}},t)})))},J=e=>{let{body:t,length:a,widthStyle:n}=e;return r.a.createElement(r.a.Fragment,null,t.map(e=>r.a.createElement("div",{className:"portfolio-body",key:Object(h.uniqueId)(),style:{width:a+"px"}},Object.entries(e).map(e=>{let[t,a]=e;return r.a.createElement("div",{key:Object(h.uniqueId)(),style:{width:n[t]+"px",textAlign:new RegExp(/\d,\d/).test(a)?"right":"count"===t?"right":null}},a)}))))};var Y=()=>{const[e,t]=Object(n.useState)(null),[a,l]=Object(n.useState)("load"),[c,i]=Object(n.useState)("All"),[o,s]=Object(n.useState)(new A("-"));return Object(n.useEffect)(()=>{u.a.get("https://d5dpil1j3vqslj3529om.apigw.yandexcloud.net/api/v1/portfolio").then(e=>{let{data:t}=e;const a=new A(b(t[0].date_daily));a.addData(t),s(a),l("loaded")}).catch(e=>{const a=e.code;t(a)})},[]),null!==e?B(e):"load"===a?r.a.createElement(j,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(P,{activeType:c,setActiveType:i}),r.a.createElement("div",{className:"table"},r.a.createElement(W,{tags:o.getTags(),length:o.getLength()}),r.a.createElement(K,{info:o.getInfoForLine(c),length:o.getLength()}),r.a.createElement("div",{className:"table-body"},r.a.createElement(J,{body:o.getData(c),length:o.getLength(),widthStyle:o.getStyleByActiveName()}))))};var H=()=>r.a.createElement(o.a,null,r.a.createElement(i.d,null,r.a.createElement(i.b,{path:"/",element:r.a.createElement(m,null)},r.a.createElement(i.b,{path:"transactions",element:r.a.createElement(D,null)}),r.a.createElement(i.b,{path:"transactions/import",element:r.a.createElement(p,null)}),r.a.createElement(i.b,{path:"*",element:r.a.createElement(Y,null)}))));a(77),a(78);c.a.createRoot(document.getElementById("root")).render(r.a.createElement(H,null))}},[[59,1,2]]]);
//# sourceMappingURL=main.d9c556d6.chunk.js.map